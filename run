#!/usr/bin/env bash
set -euo pipefail

# Check for Docker
if ! command -v docker &> /dev/null; then
    echo "Error: Docker is not installed. Please install Docker first."
    exit 1
fi

# Determine docker compose command (v2 plugin or v1 standalone)
if docker compose version &> /dev/null; then
    COMPOSE="docker compose"
elif command -v docker-compose &> /dev/null; then
    COMPOSE="docker-compose"
else
    echo "Error: Docker Compose is not available. Please install Docker Compose."
    exit 1
fi

# Copy .env.example to .env if .env doesn't exist
if [ ! -f .env ]; then
    echo "Creating .env from .env.example..."
    cp .env.example .env
fi

# Start the stack
echo "Starting Semantic Search..."
$COMPOSE -f compose.yaml --env-file .env up --build

echo ""
echo "Semantic Search is running at http://localhost:8080"
